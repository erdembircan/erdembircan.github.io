1:"$Sreact.fragment"
2:I[4205,["619","static/chunks/619-ba102abea3e3d0e4.js","177","static/chunks/app/layout-9fa69e50d7a54f20.js"],"default"]
3:I[9766,[],""]
4:I[8924,[],""]
6:I[4431,[],"OutletBoundary"]
8:I[5278,[],"AsyncMetadataOutlet"]
a:I[4431,[],"ViewportBoundary"]
c:I[4431,[],"MetadataBoundary"]
d:"$Sreact.suspense"
f:I[7150,[],""]
:HL["/_next/static/media/4cf2300e9c8272f7-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/bf148c4dfe225d7c.css","style"]
0:{"P":null,"b":"L4TZ1_VPx_Np6sCEcP-GP","p":"","c":["","blog","blog-testing-unauthenticated-cpt-requests"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","blog-testing-unauthenticated-cpt-requests","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/bf148c4dfe225d7c.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__variable_188709 __variable_9a8899 antialiased","children":[["$","$L2",null,{}],["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","footer",null,{"className":"py-6","children":["$","div",null,{"className":"max-w-6xl mx-auto px-8","children":["$","section",null,{"className":"p-12 bg-gradient-to-br from-accent to-accent-secondary rounded-[20px] text-white text-center","children":[["$","h2",null,{"className":"text-4xl font-bold mb-4","children":"Let's Build Something Amazing"}],["$","p",null,{"className":"text-lg mb-8 opacity-95 max-w-2xl mx-auto","children":"Whether you need WordPress expertise, want to collaborate on a project, or just want to chat about plugin architecture and modern development practices, I'd love to hear from you!"}],["$","div",null,{"className":"flex gap-4 justify-center flex-wrap","children":[["$","a","Get in Touch",{"href":"mailto:erdem.erdembircan@gmail.com","className":"px-8 py-3.5 bg-white text-accent font-semibold rounded-lg hover:-translate-y-0.5 hover:shadow-xl transition-all","children":"Get in Touch"}],["$","a","View My GitHub",{"href":"https://github.com/erdembircan","className":"px-8 py-3.5 bg-transparent border-2 border-white text-white font-semibold rounded-lg hover:bg-white hover:text-accent transition-all","children":"View My GitHub"}]]}]]}]}]}]]}]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["slug","blog-testing-unauthenticated-cpt-requests","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L5",null,["$","$L6",null,{"children":["$L7",["$","$L8",null,{"promise":"$@9"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Lc",null,{"children":["$","div",null,{"hidden":true,"children":["$","$d",null,{"fallback":null,"children":"$Le"}]}]}]]}],false]],"m":"$undefined","G":["$f",[]],"s":false,"S":true}
5:["$","div",null,{"className":"min-h-screen p-8","children":["$","article",null,{"className":"max-w-4xl mx-auto","children":[["$","header",null,{"className":"mb-8","children":[["$","h1",null,{"className":"text-4xl font-bold mb-4","children":"WordPress CPTs and the REST API Read Permission Gap"}],["$","p",null,{"className":"text-sm text-foreground/70 mb-4","children":"2/18/2026"}],["$","div",null,{"className":"flex gap-2 flex-wrap","children":[["$","span","0",{"className":"text-xs border border-foreground/30 px-2 py-1","children":"wordpress"}],["$","span","1",{"className":"text-xs border border-foreground/30 px-2 py-1","children":"rest-api"}],["$","span","2",{"className":"text-xs border border-foreground/30 px-2 py-1","children":"playwright"}],["$","span","3",{"className":"text-xs border border-foreground/30 px-2 py-1","children":"testing"}]]}]]}],["$","div",null,{"className":"prose prose-invert max-w-none","children":"$L10"}]]}]}]
11:T40b,class PrivatePostController extends WP_REST_Posts_Controller {

    public function get_items_permissions_check($request) {
        $post_type = get_post_type_object($this->post_type);

        if (!current_user_can($post_type->cap->edit_posts)) {
            return new WP_Error(
                'rest_forbidden',
                __('Sorry, you are not allowed to access this resource.'),
                ['status' => rest_authorization_required_code()]
            );
        }

        return parent::get_items_permissions_check($request);
    }

    public function get_item_permissions_check($request) {
        $post_type = get_post_type_object($this->post_type);

        if (!current_user_can($post_type->cap->edit_posts)) {
            return new WP_Error(
                'rest_forbidden',
                __('Sorry, you are not allowed to access this resource.'),
                ['status' => rest_authorization_required_code()]
            );
        }

        return parent::get_item_permissions_check($request);
    }
}
10:[["$","p",null,{"children":["You register a custom post type with ",["$","code",null,{"children":"'public' => false"}]," and map every capability to a custom one. You expect unauthenticated users to be locked out entirely. Then you write a Playwright test, fire a ",["$","code",null,{"children":"GET /wp-json/wp/v2/your_cpt"}],", and it returns ",["$","code",null,{"children":"200 OK"}]," with an empty array."]}],"\n",["$","p",null,{"children":"What happened?"}],"\n",["$","h2",null,{"children":"The Problem"}],"\n",["$","p",null,{"children":"WordPress treats REST API read permissions differently from write permissions. When you register a CPT with custom capabilities:"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"register_post_type('pv_upwork', [\n    'public'       => false,\n    'show_in_rest' => true,\n    'capabilities' => [\n        'edit_posts'   => 'manage_pitchvault',\n        'create_posts' => 'manage_pitchvault',\n        'delete_posts' => 'manage_pitchvault',\n        // ... every cap mapped to manage_pitchvault\n    ],\n]);\n"}]}],"\n",["$","p",null,{"children":["Write endpoints (",["$","code",null,{"children":"POST"}],", ",["$","code",null,{"children":"DELETE"}],") correctly check ",["$","code",null,{"children":"create_posts"}]," / ",["$","code",null,{"children":"delete_posts"}]," and return ",["$","code",null,{"children":"401"}]," for anonymous users. But ",["$","code",null,{"children":"GET"}]," requests go through ",["$","code",null,{"children":"WP_REST_Posts_Controller::get_items_permissions_check()"}],", which allows read access as long as the query parameters are \"safe.\" If you're only requesting published posts with no special filters, WordPress says \"sure, go ahead\" -- regardless of your capability mapping."]}],"\n",["$","p",null,{"children":["The reasoning is that ",["$","code",null,{"children":"public => false"}]," controls visibility in the admin UI and query defaults, not REST API read access. And ",["$","code",null,{"children":"show_in_rest => true"}]," explicitly opts the post type into the API. WordPress assumes that if you opted in, you want public reads."]}],"\n",["$","p",null,{"children":"That's a reasonable default for most post types. Not for ours."}],"\n",["$","h2",null,{"children":"The Fix: A Custom REST Controller"}],"\n",["$","p",null,{"children":"The solution is a custom controller that enforces your capability on read endpoints:"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"$11"}]}],"\n",["$","p",null,{"children":"Then wire it up during registration:"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"language-php","children":"register_post_type('pv_upwork', [\n    'rest_controller_class' => PrivatePostController::class,\n    // ... rest of args\n]);\n"}]}],"\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27"]
12:["$","p",null,{"children":["Now both ",["$","code",null,{"children":"get_items"}]," (list) and ",["$","code",null,{"children":"get_item"}]," (single) check the mapped capability before proceeding. Anonymous users get ",["$","code",null,{"children":"401"}],". Authorized users fall through to the parent's check, which handles edge cases like post status and password protection."]}]
13:["$","h2",null,{"children":"Testing It with Playwright"}]
14:["$","p",null,{"children":["This is where things get interesting. Our authenticated tests use ",["$","code",null,{"children":"@wordpress/e2e-test-utils-playwright"}],", which provides a ",["$","code",null,{"children":"requestUtils"}]," fixture. This fixture handles authentication automatically -- it logs in as ",["$","code",null,{"children":"admin"}]," and attaches cookies/nonce to every request:"]}]
15:["$","pre",null,{"children":["$","code",null,{"className":"language-typescript","children":"import { test, expect } from '@wordpress/e2e-test-utils-playwright';\n\ntest('REST API endpoint exists and responds', async ({ requestUtils }) => {\n  const response = await requestUtils.rest({\n    path: '/wp/v2/pv_upwork',\n    method: 'GET',\n  });\n  expect(Array.isArray(response)).toBe(true);\n});\n"}]}]
16:["$","p",null,{"children":["But ",["$","code",null,{"children":"requestUtils"}]," always sends authenticated requests. You can't use it to test what an anonymous visitor sees."]}]
17:["$","h3",null,{"children":"Two Playground Instances"}]
18:["$","p",null,{"children":["We run WordPress Playground as our test backend. The key insight: we spin up ",["$","strong",null,{"children":"two separate instances"}]," with different blueprints."]}]
19:["$","p",null,{"children":["The authenticated instance includes a ",["$","code",null,{"children":"login"}]," step in its blueprint:"]}]
1a:["$","pre",null,{"children":["$","code",null,{"className":"language-typescript","children":"const loginStep = [{ step: 'login', username: 'admin' }];\n\nexport const setupBlueprint = {\n  preferredVersions: { php: '8.2', wp: 'latest' },\n  steps: [...loginStep, ...debugStep, ...pluginStep],\n};\n"}]}]
1b:["$","p",null,{"children":["The Playground ",["$","code",null,{"children":"login"}]," step creates a session cookie that ",["$","code",null,{"children":"@wordpress/e2e-test-utils-playwright"}]," picks up. Every ",["$","code",null,{"children":"requestUtils.rest()"}]," call sends this cookie, so WordPress sees an authenticated admin user."]}]
1c:["$","p",null,{"children":"The unauthenticated instance skips the login step entirely:"}]
1d:["$","pre",null,{"children":["$","code",null,{"className":"language-typescript","children":"export const setupBlueprintNoLogin = {\n  preferredVersions: { php: '8.2', wp: 'latest' },\n  steps: [...debugStep, ...pluginStep],\n};\n"}]}]
1e:["$","p",null,{"children":"No login, no cookie, no session. This instance runs on a different port."}]
1f:["$","h3",null,{"children":"Separate Test Projects"}]
20:["$","p",null,{"children":"Playwright's config maps each instance to a test project:"}]
21:["$","pre",null,{"children":["$","code",null,{"className":"language-typescript","children":"export default defineConfig({\n  webServer: [\n    { command: 'pnpm playground:test' /* port 9401 */ },\n    { command: 'pnpm playground:test-noauth' /* port 9402 */ },\n  ],\n  projects: [\n    {\n      name: 'authenticated',\n      testDir: './tests/e2e',\n      use: { baseURL: 'http://127.0.0.1:9401' },\n    },\n    {\n      name: 'unauthenticated',\n      testDir: './tests/e2e-unauth',\n      use: { baseURL: 'http://127.0.0.1:9402' },\n    },\n  ],\n});\n"}]}]
22:["$","h3",null,{"children":"Raw Playwright for Unauthenticated Tests"}]
23:["$","p",null,{"children":["Since ",["$","code",null,{"children":"requestUtils"}]," always authenticates, the unauthenticated tests use Playwright's raw ",["$","code",null,{"children":"request"}]," API instead:"]}]
24:["$","pre",null,{"children":["$","code",null,{"className":"language-typescript","children":"import { test, expect, request } from '@playwright/test';\n\ntest('listing posts should fail', async ({ baseURL }) => {\n  const api = await request.newContext({ baseURL: baseURL! });\n  const response = await api.get('/wp-json/wp/v2/pv_upwork');\n  expect(response.status()).toBe(401);\n  await api.dispose();\n});\n"}]}]
25:["$","p",null,{"children":["Note the import: ",["$","code",null,{"children":"@playwright/test"}],", not ",["$","code",null,{"children":"@wordpress/e2e-test-utils-playwright"}],". No fixtures, no auth, just a plain HTTP request against the no-login instance."]}]
26:["$","h2",null,{"children":"The Takeaway"}]
27:["$","p",null,{"children":["WordPress REST API permissions have a split personality: writes check capabilities, reads often don't. If your CPT is private, ",["$","code",null,{"children":"'public' => false"}]," alone won't protect the REST endpoints. You need a custom controller to close the gap -- and you need separate test environments to verify both sides of that gap."]}]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
7:null
28:I[622,[],"IconMark"]
9:{"metadata":[["$","title","0",{"children":"Erdem Bircan | WordPress Architect & Developer"}],["$","meta","1",{"name":"description","content":"WordPress software architect specializing in plugin development, Gutenberg blocks, and scalable architectures. 10 years building production-grade products."}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","$L28","3",{}]],"error":null,"digest":"$undefined"}
e:"$9:metadata"
